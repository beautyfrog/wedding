package summerlee.wedding.controller;import java.util.Random;import java.util.concurrent.TimeUnit;import javax.servlet.http.HttpServletRequest;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import summerlee.wedding.websocket.Broadcaster;/** * 基础控制器 *  * @file BaseController * @author libin * @Create 2016-12-26 */@Controllerpublic class ShowController {		@RequestMapping(value="/")	public String index(Model model, HttpServletRequest request) {		model.addAttribute("host", request.getHeader("Host"));		model.addAttribute("port", request.getLocalPort());		return "index";	}		@RequestMapping(value="/pop")	public @ResponseBody String danmu(String danmu) {		new Thread(){			@Override			public void run() {				Random r = new Random();				StringBuffer s = new StringBuffer();				while(true){					for(int j=0; j<2; j++){						s.delete(0, s.length());						for(int i=0; i<6; i++){							s.append((char)(97+r.nextInt(26)));						}						Broadcaster.addDanmu(s.toString());					}					try {						//Thread.sleep(500L);						Thread.sleep(TimeUnit.SECONDS.toMillis(1));					} catch (Exception e) {											}				}			}		}.start();		Broadcaster.addDanmu(danmu);		return "success";	}}